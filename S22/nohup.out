Using 16-bit Automatic Mixed Precision (AMP)
{'model_name': 'pythia-160m', 'name': 'redpajama', 'save_interval': 1000, 'eval_interval': 1000, 'eval_iters': 100, 'log_interval': 100, 'learning_rate': 0.006, 'batch_size': 8, 'micro_batch_size': 4, 'gradient_accumulation_steps': 2, 'max_iters': 15000, 'weight_decay': 0.1, 'beta1': 0.9, 'beta2': 0.95, 'grad_clip': 1.0, 'decay_lr': True, 'warmup_iters': 2000, 'lr_decay_iters': 15000, 'min_lr': 6e-06}
Seed set to 1337
Loading model with {'name': 'pythia-160m', 'hf_config': {'org': 'EleutherAI', 'name': 'pythia-160m-deduped'}, 'block_size': 2048, 'vocab_size': 50254, 'padding_multiple': 128, 'padded_vocab_size': 50304, 'n_layer': 12, 'n_head': 12, 'n_embd': 768, 'rotary_percentage': 0.25, 'parallel_residual': True, 'bias': True, 'lm_head_bias': False, 'n_query_groups': 12, 'shared_attention_norm': False, '_norm_class': 'LayerNorm', 'norm_eps': 1e-05, '_mlp_class': 'GptNeoxMLP', 'gelu_approximate': 'none', 'intermediate_size': 3072, 'rope_condense_ratio': 1, 'rope_base': 10000, 'head_size': 64, 'rope_n_elem': 16}
Time to instantiate model: 0.30 seconds.
Total parameters 162,322,944
Estimated TFLOPs: 11.07
Measured TFLOPs: 7.93
iter 0 step 0: loss 10.9759, LR: 0.000000, iter time: 970.90ms
iter 100 step 50: loss 7.3099, LR: 0.000300, iter time: 149.44ms
iter 200 step 100: loss 5.9818, LR: 0.000600, iter time: 152.11ms
iter 300 step 150: loss 6.5674, LR: 0.000900, iter time: 153.65ms
iter 400 step 200: loss 6.4559, LR: 0.001200, iter time: 153.00ms
iter 500 step 250: loss 5.8150, LR: 0.001500, iter time: 152.60ms
iter 600 step 300: loss 5.8375, LR: 0.001800, iter time: 150.26ms
iter 700 step 350: loss 6.0346, LR: 0.002100, iter time: 150.61ms
iter 800 step 400: loss 5.6895, LR: 0.002400, iter time: 154.05ms
iter 900 step 450: loss 5.3467, LR: 0.002700, iter time: 148.69ms
iter 1000 step 500: loss 5.5199, LR: 0.003000, iter time: 147.75ms
iter 1100 step 550: loss 5.5256, LR: 0.003300, iter time: 147.17ms
iter 1200 step 600: loss 6.2611, LR: 0.003600, iter time: 150.42ms
iter 1300 step 650: loss 5.4748, LR: 0.003900, iter time: 146.21ms
iter 1400 step 700: loss 5.4261, LR: 0.004200, iter time: 147.65ms
iter 1500 step 750: loss 5.2750, LR: 0.004500, iter time: 146.02ms
iter 1600 step 800: loss 4.9024, LR: 0.004800, iter time: 146.80ms
iter 1700 step 850: loss 5.3979, LR: 0.005100, iter time: 146.44ms
iter 1800 step 900: loss 5.7637, LR: 0.005400, iter time: 144.87ms
iter 1900 step 950: loss 5.4498, LR: 0.005700, iter time: 145.10ms
Saving checkpoint to 'out/redpajama/iter-001999-ckpt.pth'
iter 2000 step 1000: loss 5.2741, LR: 0.006000, iter time: 169.19ms
iter 2100 step 1050: loss 5.4275, LR: 0.005999, iter time: 143.74ms
iter 2200 step 1100: loss 5.3399, LR: 0.005997, iter time: 146.02ms
iter 2300 step 1150: loss 5.7130, LR: 0.005992, iter time: 143.76ms
iter 2400 step 1200: loss 5.3070, LR: 0.005986, iter time: 144.70ms
iter 2500 step 1250: loss 5.5494, LR: 0.005978, iter time: 143.71ms
iter 2600 step 1300: loss 5.5811, LR: 0.005969, iter time: 138.07ms
iter 2700 step 1350: loss 5.4376, LR: 0.005957, iter time: 143.84ms
iter 2800 step 1400: loss 5.1053, LR: 0.005944, iter time: 147.78ms
iter 2900 step 1450: loss 5.4406, LR: 0.005929, iter time: 144.33ms
iter 3000 step 1500: loss 5.2908, LR: 0.005913, iter time: 144.44ms
iter 3100 step 1550: loss 5.2485, LR: 0.005895, iter time: 139.94ms
iter 3200 step 1600: loss 5.8494, LR: 0.005875, iter time: 144.15ms
iter 3300 step 1650: loss 5.6168, LR: 0.005853, iter time: 142.51ms
iter 3400 step 1700: loss 5.5048, LR: 0.005830, iter time: 148.43ms
iter 3500 step 1750: loss 4.9307, LR: 0.005805, iter time: 144.34ms
iter 3600 step 1800: loss 4.7334, LR: 0.005779, iter time: 145.36ms
iter 3700 step 1850: loss 5.0472, LR: 0.005751, iter time: 146.17ms
iter 3800 step 1900: loss 5.3208, LR: 0.005721, iter time: 144.76ms
iter 3900 step 1950: loss 5.1263, LR: 0.005690, iter time: 147.65ms
Saving checkpoint to 'out/redpajama/iter-003999-ckpt.pth'
iter 4000 step 2000: loss 5.1204, LR: 0.005657, iter time: 172.75ms
iter 4100 step 2050: loss 5.1474, LR: 0.005622, iter time: 140.54ms
iter 4200 step 2100: loss 5.3465, LR: 0.005586, iter time: 147.43ms
iter 4300 step 2150: loss 5.0418, LR: 0.005549, iter time: 140.41ms
iter 4400 step 2200: loss 4.9890, LR: 0.005510, iter time: 139.89ms
iter 4500 step 2250: loss 4.9930, LR: 0.005469, iter time: 144.87ms
iter 4600 step 2300: loss 4.8925, LR: 0.005428, iter time: 135.69ms
iter 4700 step 2350: loss 4.8526, LR: 0.005384, iter time: 146.17ms
iter 4800 step 2400: loss 5.1815, LR: 0.005340, iter time: 147.15ms
iter 4900 step 2450: loss 4.9220, LR: 0.005294, iter time: 145.23ms
iter 5000 step 2500: loss 4.2274, LR: 0.005246, iter time: 148.30ms
iter 5100 step 2550: loss 5.4449, LR: 0.005198, iter time: 149.70ms
iter 5200 step 2600: loss 4.8027, LR: 0.005148, iter time: 149.99ms
iter 5300 step 2650: loss 5.7233, LR: 0.005096, iter time: 148.33ms
iter 5400 step 2700: loss 5.2702, LR: 0.005044, iter time: 149.27ms
iter 5500 step 2750: loss 4.9851, LR: 0.004990, iter time: 150.35ms
iter 5600 step 2800: loss 4.9335, LR: 0.004936, iter time: 150.73ms
iter 5700 step 2850: loss 4.7351, LR: 0.004880, iter time: 148.36ms
iter 5800 step 2900: loss 5.0087, LR: 0.004823, iter time: 150.38ms
iter 5900 step 2950: loss 4.7235, LR: 0.004765, iter time: 148.73ms
Saving checkpoint to 'out/redpajama/iter-005999-ckpt.pth'
iter 6000 step 3000: loss 5.2332, LR: 0.004705, iter time: 172.67ms
iter 6100 step 3050: loss 4.8622, LR: 0.004645, iter time: 152.09ms
iter 6200 step 3100: loss 5.1276, LR: 0.004584, iter time: 140.29ms
iter 6300 step 3150: loss 4.7737, LR: 0.004522, iter time: 150.52ms
iter 6400 step 3200: loss 5.3575, LR: 0.004459, iter time: 151.14ms
iter 6500 step 3250: loss 4.8428, LR: 0.004396, iter time: 147.37ms
iter 6600 step 3300: loss 4.3238, LR: 0.004331, iter time: 149.61ms
iter 6700 step 3350: loss 4.5327, LR: 0.004266, iter time: 150.62ms
iter 6800 step 3400: loss 4.7463, LR: 0.004200, iter time: 143.50ms
iter 6900 step 3450: loss 3.9771, LR: 0.004133, iter time: 147.67ms
iter 7000 step 3500: loss 5.1692, LR: 0.004066, iter time: 152.56ms
iter 7100 step 3550: loss 4.3907, LR: 0.003998, iter time: 148.49ms
iter 7200 step 3600: loss 4.4906, LR: 0.003929, iter time: 150.65ms
iter 7300 step 3650: loss 4.3029, LR: 0.003860, iter time: 151.79ms
iter 7400 step 3700: loss 4.9293, LR: 0.003790, iter time: 148.59ms
iter 7500 step 3750: loss 4.3262, LR: 0.003720, iter time: 148.08ms
iter 7600 step 3800: loss 4.9719, LR: 0.003650, iter time: 146.91ms
iter 7700 step 3850: loss 4.3872, LR: 0.003579, iter time: 141.36ms
iter 7800 step 3900: loss 4.4064, LR: 0.003508, iter time: 141.57ms
iter 7900 step 3950: loss 4.4386, LR: 0.003436, iter time: 151.47ms
Saving checkpoint to 'out/redpajama/iter-007999-ckpt.pth'
iter 8000 step 4000: loss 4.3831, LR: 0.003364, iter time: 172.56ms
iter 8100 step 4050: loss 4.5383, LR: 0.003292, iter time: 152.39ms
iter 8200 step 4100: loss 3.9031, LR: 0.003220, iter time: 149.43ms
iter 8300 step 4150: loss 3.5748, LR: 0.003148, iter time: 149.64ms
iter 8400 step 4200: loss 4.1993, LR: 0.003075, iter time: 150.36ms
iter 8500 step 4250: loss 4.1088, LR: 0.003003, iter time: 148.68ms
iter 8600 step 4300: loss 4.3328, LR: 0.002931, iter time: 148.04ms
iter 8700 step 4350: loss 4.0336, LR: 0.002858, iter time: 148.42ms
iter 8800 step 4400: loss 4.0877, LR: 0.002786, iter time: 147.04ms
iter 8900 step 4450: loss 4.3337, LR: 0.002714, iter time: 149.55ms
iter 9000 step 4500: loss 4.1586, LR: 0.002642, iter time: 151.11ms
iter 9100 step 4550: loss 2.9625, LR: 0.002570, iter time: 148.14ms
iter 9200 step 4600: loss 4.3357, LR: 0.002498, iter time: 133.16ms
iter 9300 step 4650: loss 4.2010, LR: 0.002427, iter time: 143.65ms
iter 9400 step 4700: loss 3.8034, LR: 0.002356, iter time: 151.56ms
iter 9500 step 4750: loss 4.1023, LR: 0.002286, iter time: 152.82ms
iter 9600 step 4800: loss 4.0755, LR: 0.002216, iter time: 148.33ms
iter 9700 step 4850: loss 3.8974, LR: 0.002146, iter time: 149.03ms
iter 9800 step 4900: loss 4.0549, LR: 0.002077, iter time: 147.39ms
iter 9900 step 4950: loss 3.3813, LR: 0.002008, iter time: 148.53ms
Saving checkpoint to 'out/redpajama/iter-009999-ckpt.pth'
iter 10000 step 5000: loss 4.0582, LR: 0.001940, iter time: 163.42ms
iter 10100 step 5050: loss 3.7373, LR: 0.001873, iter time: 148.63ms
iter 10200 step 5100: loss 4.2523, LR: 0.001806, iter time: 151.15ms
iter 10300 step 5150: loss 4.0377, LR: 0.001740, iter time: 148.10ms
iter 10400 step 5200: loss 3.9281, LR: 0.001675, iter time: 150.30ms
iter 10500 step 5250: loss 4.5007, LR: 0.001610, iter time: 148.97ms
iter 10600 step 5300: loss 4.2599, LR: 0.001547, iter time: 149.60ms
iter 10700 step 5350: loss 3.9695, LR: 0.001484, iter time: 137.81ms
iter 10800 step 5400: loss 4.0384, LR: 0.001422, iter time: 147.53ms
iter 10900 step 5450: loss 4.2085, LR: 0.001361, iter time: 150.71ms
iter 11000 step 5500: loss 3.7166, LR: 0.001301, iter time: 151.22ms
iter 11100 step 5550: loss 3.6536, LR: 0.001241, iter time: 147.66ms
iter 11200 step 5600: loss 4.2005, LR: 0.001183, iter time: 149.45ms
iter 11300 step 5650: loss 3.8662, LR: 0.001126, iter time: 148.72ms
iter 11400 step 5700: loss 4.1690, LR: 0.001070, iter time: 147.96ms
iter 11500 step 5750: loss 3.2216, LR: 0.001016, iter time: 149.73ms
iter 11600 step 5800: loss 3.5067, LR: 0.000962, iter time: 149.77ms
iter 11700 step 5850: loss 4.0957, LR: 0.000910, iter time: 149.79ms
iter 11800 step 5900: loss 3.4854, LR: 0.000858, iter time: 149.34ms
iter 11900 step 5950: loss 4.0641, LR: 0.000808, iter time: 152.70ms
Saving checkpoint to 'out/redpajama/iter-011999-ckpt.pth'
iter 12000 step 6000: loss 3.5108, LR: 0.000760, iter time: 161.69ms
iter 12100 step 6050: loss 3.4321, LR: 0.000712, iter time: 151.07ms
iter 12200 step 6100: loss 4.1952, LR: 0.000666, iter time: 150.56ms
iter 12300 step 6150: loss 3.5607, LR: 0.000622, iter time: 150.87ms
iter 12400 step 6200: loss 3.8252, LR: 0.000578, iter time: 150.58ms
iter 12500 step 6250: loss 3.4465, LR: 0.000537, iter time: 150.28ms
iter 12600 step 6300: loss 3.8419, LR: 0.000496, iter time: 154.02ms
iter 12700 step 6350: loss 3.8505, LR: 0.000457, iter time: 147.82ms
iter 12800 step 6400: loss 4.1035, LR: 0.000420, iter time: 153.71ms
iter 12900 step 6450: loss 3.9737, LR: 0.000384, iter time: 151.83ms
iter 13000 step 6500: loss 3.3557, LR: 0.000349, iter time: 150.73ms
iter 13100 step 6550: loss 4.0581, LR: 0.000316, iter time: 148.33ms
iter 13200 step 6600: loss 3.8734, LR: 0.000285, iter time: 152.75ms
iter 13300 step 6650: loss 3.7015, LR: 0.000255, iter time: 151.16ms
iter 13400 step 6700: loss 3.2697, LR: 0.000227, iter time: 148.78ms
iter 13500 step 6750: loss 4.0535, LR: 0.000201, iter time: 150.93ms
iter 13600 step 6800: loss 3.8641, LR: 0.000176, iter time: 153.12ms
iter 13700 step 6850: loss 3.4970, LR: 0.000153, iter time: 149.49ms
iter 13800 step 6900: loss 3.8648, LR: 0.000131, iter time: 146.42ms
iter 13900 step 6950: loss 3.5658, LR: 0.000111, iter time: 152.29ms
Saving checkpoint to 'out/redpajama/iter-013999-ckpt.pth'
iter 14000 step 7000: loss 3.7532, LR: 0.000093, iter time: 172.51ms
iter 14100 step 7050: loss 2.8010, LR: 0.000077, iter time: 152.83ms
iter 14200 step 7100: loss 3.8824, LR: 0.000062, iter time: 151.08ms
iter 14300 step 7150: loss 4.1135, LR: 0.000049, iter time: 148.48ms
iter 14400 step 7200: loss 3.9040, LR: 0.000037, iter time: 152.47ms
iter 14500 step 7250: loss 3.3551, LR: 0.000028, iter time: 150.73ms
iter 14600 step 7300: loss 3.4726, LR: 0.000020, iter time: 149.23ms
iter 14700 step 7350: loss 4.0697, LR: 0.000014, iter time: 149.32ms
iter 14800 step 7400: loss 3.9101, LR: 0.000009, iter time: 151.09ms
iter 14900 step 7450: loss 3.3614, LR: 0.000007, iter time: 148.98ms
Saving checkpoint to 'out/redpajama/iter-015000-ckpt.pth'
Training time: 9053.25s
Memory used: 12.25 GB
